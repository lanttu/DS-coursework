<!DOCTYPE HTML>
<html lang="en">
<head>
    <title>Browser test</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>
    <button id="connect">Connect</button>
    <button id="disconnect">Disconnect</button>


</body>
<script>

var address = 'http://localhost:3000';
var socket = null;

$('#connect').click(function () {
    if (!socket) {
        socket = io.connect(address);
        initSocket(socket);
        console.info('Connecting...');
    } else {
        console.info('Already connected');
    }
})

$('#disconnect').click(function () {
    if (socket) {
        console.info('Disconnecting...');
        socket.disconnect();
        socket = null;
    } else {
        console.info('No connection');
    }
});

function initSocket (s) {
    s.on('handshake', function (accepted) {
        console.info('<< handshake', accepted);
        if (!accepted && s === socket) socket = null;
    });

    s.on('disconnect', function () {
        console.info('Disconneted');
        if (s === socket) {
            socket = null;
        }
    });
}
</script>
</html>